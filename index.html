<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Super Sena — Skin Studio Pro (Mini Photoshop)</title>
<meta name="description" content="Editor online de skins 4096x4096 para ETS2 — export, camadas, texto, zoom, pan, recorte, filtros." />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#071018; --card:#071a22; --accent:#f0b429; --muted:#98b4bb; --glass:rgba(255,255,255,0.03);
  font-family:"Inter",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
}
*{box-sizing:border-box}
body{margin:0;background:linear-gradient(180deg,#041018 0%,#071427 60%);color:#e6f6f9}
.wrap{max-width:1600px;margin:0 auto;padding:12px;display:flex;flex-direction:column;gap:12px}
header{display:flex;gap:12px;align-items:center}
.logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#ffdf87);display:flex;align-items:center;justify-content:center;font-weight:800;color:#071018;font-size:22px}
h1{font-size:22px;margin:0}
p.lead{color:var(--muted);margin:0}
.main{display:flex;gap:12px;flex:1;min-height:80vh}
.editor-wrap{flex:3;display:flex;flex-direction:column;background:#fff;border-radius:12px;overflow:hidden;position:relative}
#viewWrap{flex:1;display:flex;align-items:center;justify-content:center;background:#fff;cursor:grab;overflow:hidden;position:relative}
canvas#view{background:#fff;display:block;max-width:100%;max-height:100%;border-radius:0}
.rightPanel{flex:1;display:flex;flex-direction:column;gap:12px}
.card{background:var(--card);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:8px}
.controls label{font-size:13px;color:var(--muted)}
input,select,textarea,button{font-family:inherit}
input[type="range"]{width:100%}
button.btn{background:var(--accent);color:#071018;padding:8px 10px;border-radius:8px;font-weight:700;border:none;cursor:pointer}
button.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
ul.layers{list-style:none;padding:0;margin:0;overflow:auto;max-height:300px}
ul.layers li{padding:6px;border-radius:6px;background:rgba(255,255,255,0.02);display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;font-size:12px}
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:24px;background:rgba(0,0,0,0.75);padding:10px 14px;border-radius:8px;color:#fff;display:none;z-index:9999}
footer{display:flex;justify-content:space-between;flex-wrap:wrap;color:var(--muted);font-size:13px;margin-top:12px;gap:8px}
</style>
</head>
<body>
<div class="wrap">
<header>
<div class="logo">SS</div>
<div>
<h1>Super Sena — Skin Studio Pro</h1>
<p class="lead">Editor 4096×4096 — Mini Photoshop Canvas</p>
</div>
</header>

<div style="display:flex;gap:8px;flex-wrap:wrap">
<a class="btn" href="#studio">Ir para o Studio</a>
<a class="btn ghost" href="https://instagram.com/supersena7" target="_blank">Instagram</a>
<a class="btn ghost" href="https://discord.gg/8SzFU4BnnB" target="_blank">Discord</a>
</div>

<section id="studio" class="main">
<div class="editor-wrap">
<div class="controls card">
<label>Upload template (PNG/JPG)</label>
<input type="file" id="templateFile" accept="image/*">
<label>Upload imagem/logo</label>
<input type="file" id="imageFile" accept="image/*">
<label>Adicionar texto</label>
<div style="display:flex;gap:6px">
<input type="text" id="textInput" placeholder="Texto da skin" style="flex:1">
<button class="btn ghost" id="addTextBtn">Adicionar</button>
</div>
<label>Fonte</label>
<select id="fontSelect">
<option value="Inter">Inter</option>
<option value="Arial">Arial</option>
<option value="Georgia">Georgia</option>
<option value="Impact">Impact</option>
</select>
<label>Tamanho do texto</label>
<input type="range" id="textSize" min="12" max="400" value="72">
<label>Cor do texto</label>
<input type="color" id="textColor" value="#000000">
<div style="display:flex;gap:6px;margin-top:6px">
<button class="btn" id="exportClean">Exportar Sem Template</button>
<button class="btn ghost" id="exportWith">Exportar Com Template</button>
</div>
<div style="display:flex;gap:6px;margin-top:6px">
<button class="btn" id="saveProj">Salvar Projeto</button>
<button class="btn ghost" id="loadProj">Carregar Projeto</button>
<button class="btn ghost" id="resetProj">Resetar</button>
</div>
</div>

<div id="viewWrap">
<canvas id="view" width="800" height="800"></canvas>
</div>
</div>

<aside class="rightPanel">
<div class="card">
<strong>Camadas</strong>
<ul class="layers" id="layersList"></ul>
<div style="display:flex;gap:6px;margin-top:6px">
<button class="btn ghost" id="bringFront">Trazer Frente</button>
<button class="btn ghost" id="sendBack">Mandar Fundo</button>
</div>
</div>

<div class="card" id="layerControls" style="display:none">
<strong>Controle da camada</strong>
<label>Escala</label>
<input type="range" id="layerScale" min="0.05" max="3" step="0.01" value="1">
<label>Rotação (°)</label>
<input type="range" id="layerRot" min="-180" max="180" step="1" value="0">
<label>Opacidade</label>
<input type="range" id="layerOpacity" min="0" max="1" step="0.01" value="1">
<div style="display:flex;gap:6px;margin-top:6px">
<button class="btn ghost" id="delLayer">Remover</button>
<button class="btn ghost" id="centerLayer">Centralizar</button>
</div>
</div>
</aside>
</section>

<footer>
<div>© Super Sena — Skin Studio Prototype</div>
<div>
<a href="https://instagram.com/supersena7" style="color:var(--muted)">Instagram</a>
<a href="https://discord.gg/8SzFU4BnnB" style="color:var(--muted)">Discord</a>
</div>
</footer>
</div>

<div class="toast" id="toast"></div>

<script>
const view=document.getElementById('view');
const ctx=view.getContext('2d');
const exportSize=4096;
const off=document.createElement('canvas');
off.width=exportSize; off.height=exportSize;
const offCtx=off.getContext('2d');
let templateImg=null;
let layers=[]; // {id,type,img/text,x,y,scale,rot,opacity,font,color,size}
let selectedId=null;
let dragging=false; let dragOffset={x:0,y:0};
let zoom=1; let offset={x:0,y:0};
function uid(){return Date.now().toString(36)+Math.random().toString(36).slice(2,8);}
function showToast(msg){const t=document.getElementById('toast');t.innerText=msg;t.style.display='block';setTimeout(()=>t.style.display='none',1800);}

// Load template
document.getElementById('templateFile').addEventListener('change',e=>{
const f=e.target.files[0]; if(!f)return;
const url=URL.createObjectURL(f); const i=new Image();
i.onload=()=>{ templateImg=i; draw(); showToast('Template carregado'); }
i.src=url;
});

// Load image/logo
document.getElementById('imageFile').addEventListener('change',e=>{
const f=e.target.files[0]; if(!f)return;
const url=URL.createObjectURL(f); const i=new Image();
i.onload=()=>{
const id=uid();
const scale=Math.min(1,(exportSize*0.25)/Math.max(i.width,i.height));
layers.push({id,type:'image',img:i,x:exportSize/2,y:exportSize/2,scale,rot:0,opacity:1});
rebuildLayersList(); draw();
}
i.src=url;
});

// Add text
document.getElementById('addTextBtn').addEventListener('click',()=>{
const txt=document.getElementById('textInput').value.trim(); if(!txt)return alert('Digite um texto');
const id=uid();
const size=parseInt(document.getElementById('textSize').value,10)||72;
const font=document.getElementById('fontSelect').value;
const color=document.getElementById('textColor').value;
layers.push({id,type:'text',text:txt,x:exportSize/2,y:exportSize/2,scale:1,rot:0,opacity:1,font,size,color});
rebuildLayersList(); draw();
document.getElementById('textInput').value='';
});

// Compose to offscreen
function composeToOff(includeTemplate=true){
offCtx.clearRect(0,0,exportSize,exportSize);
if(includeTemplate && templateImg){
offCtx.drawImage(templateImg,0,0,exportSize,exportSize);}
for(const l of layers){
offCtx.save();
offCtx.globalAlpha=l.opacity||1;
offCtx.translate(l.x,l.y);
offCtx.rotate(l.rot||0);
if(l.type==='image'){
const w=l.img.width*(l.scale||1);
const h=l.img.height*(l.scale||1);
offCtx.drawImage(l.img,-w/2,-h/2,w,h);
}else if(l.type==='text'){
offCtx.font=`${l.size||72}px ${l.font||'Inter'}`;
offCtx.fillStyle=l.color||'#000';
offCtx.textAlign='center';
offCtx.textBaseline='middle';
offCtx.scale(l.scale||1,l.scale||1);
offCtx.fillText(l.text,0,0);
}
offCtx.restore();
}
}

// Draw scaled preview
function draw(){
ctx.setTransform(1,0,0,1,0,0);
ctx.clearRect(0,0,view.width,view.height);
ctx.translate(offset.x,offset.y);
ctx.scale(zoom,zoom);
composeToOff(true);
ctx.drawImage(off,0,0,exportSize,exportSize);

// Draw selection rectangle
if(selectedId){
const s=layers.find(l=>l.id===selectedId);
if(s){
ctx.save(); ctx.strokeStyle='rgba(240,180,41,0.9)'; ctx.lineWidth=2; ctx.setLineDash([6,4]); ctx.translate(s.x,s.y); ctx.rotate(s.rot||0);
if(s.type==='image'){ const w=s.img.width*(s.scale||1); const h=s.img.height*(s.scale||1); ctx.strokeRect(-w/2,-h/2,w,h);}
else{ctx.strokeRect(-200,-(s.size||72)/2,400,(s.size||72));}
ctx.restore();
}
}
}

// View to export coords
function viewToExport(cx,cy){
const rect=view.getBoundingClientRect();
const x=(cx-rect.left-offset.x)/zoom;
const y=(cy-rect.top-offset.y)/zoom;
return {x,y};
}

// Mouse interactions
let isPanning=false; let panStart={x:0,y:0}; let panOffsetStart={x:0,y:0};
view.addEventListener('mousedown',e=>{
const p=viewToExport(e.clientX,e.clientY);
for(let i=layers.length-1;i>=0;i--){
const l=layers[i];
const dx=p.x-l.x; const dy=p.y-l.y;
const s=Math.sin(-l.rot||0); const c=Math.cos(-l.rot||0);
const lx=dx*c-dy*s; const ly=dx*s+dy*c;
if(l.type==='image'){ const w=l.img.width*(l.scale||1); const h=l.img.height*(l.scale||1);
if(Math.abs(lx)<=w/2 && Math.abs(ly)<=h/2){selectedId=l.id;dragging=true;dragOffset={x:lx,y:ly};updateLayerControls();draw(); return;}}
else{const boxW=(l.text.length*(l.size||72)*0.5)*(l.scale||1); const boxH=(l.size||72)*(l.scale||1);
if(Math.abs(lx)<=boxW/2 && Math.abs(ly)<=boxH/2){selectedId=l.id;dragging=true;dragOffset={x:lx,y:ly};updateLayerControls();draw();return;}}
}
// Pan if clicked empty
isPanning=true; panStart={x:e.clientX,y:e.clientY}; panOffsetStart={x:offset.x,y:offset.y};
});
window.addEventListener('mousemove',e=>{
if(dragging && selectedId){
const p=viewToExport(e.clientX,e.clientY);
const l=layers.find(x=>x.id===selectedId); if(!l)return;
const s=Math.sin(l.rot||0); const c=Math.cos(l.rot||0);
const wx=dragOffset.x*c+dragOffset.y*-s; const wy=dragOffset.x*s+dragOffset.y*c;
l.x=p.x-wx; l.y=p.y-wy; updateLayerControls(); draw();}
else if(isPanning){offset.x=panOffsetStart.x+(e.clientX-panStart.x); offset.y=panOffsetStart.y+(e.clientY-panStart.y); draw();}
});
window.addEventListener('mouseup',()=>{dragging=false; isPanning=false;});

// Zoom
view.addEventListener('wheel',e=>{e.preventDefault(); const z=e.deltaY<0?1.1:0.9; zoom*=z; draw();});

// Layer UI
function rebuildLayersList(){
const ul=document.getElementById('layersList'); ul.innerHTML='';
layers.forEach((l,i)=>{
const li=document.createElement('li');
li.innerHTML=`<div>${l.type==='image'?'IMG':'TXT'} ${i+1}</div><button data-id="${l.id}" class="btn ghost small">Sel</button>`;
ul.appendChild(li);
li.querySelector('button').addEventListener('click',()=>{selectedId=l.id;updateLayerControls();draw();document.getElementById('layerControls').style.display='block';});
});
}
function updateLayerControls(){const l=layers.find(x=>x.id===selectedId);if(!l)return;
document.getElementById('layerScale').value=l.scale||1;
document.getElementById('layerRot').value=(l.rot||0)*180/Math.PI;
document.getElementById('layerOpacity').value=l.opacity||1;
}
document.getElementById('layerScale').addEventListener('input',e=>{const l=layers.find(x=>x.id===selectedId);if(!l)return;l.scale=parseFloat(e.target.value);draw();});
document.getElementById('layerRot').addEventListener('input',e=>{const l=layers.find(x=>x.id===selectedId);if(!l)return;l.rot=parseFloat(e.target.value)*Math.PI/180;draw();});
document.getElementById('layerOpacity').addEventListener('input',e=>{const l=layers.find(x=>x.id===selectedId);if(!l)return;l.opacity=parseFloat(e.target.value);draw();});
document.getElementById('delLayer').addEventListener('click',()=>{layers=layers.filter(x=>x.id!==selectedId);selectedId=null;document.getElementById('layerControls').style.display='none';rebuildLayersList();draw();});
document.getElementById('centerLayer').addEventListener('click',()=>{const l=layers.find(x=>x.id===selectedId);if(!l)return;l.x=exportSize/2;l.y=exportSize/2;draw();});
document.getElementById('bringFront').addEventListener('click',()=>{if(!selectedId)return;const i=layers.findIndex(x=>x.id===selectedId);if(i>=0){const [l]=layers.splice(i,1);layers.push(l);rebuildLayersList();draw();}});
document.getElementById('sendBack').addEventListener('click',()=>{if(!selectedId)return;const i=layers.findIndex(x=>x.id===selectedId);if(i>=0){const [l]=layers.splice(i,1);layers.unshift(l);rebuildLayersList();draw();}});

// Export
function exportImage(includeTemplate){
showToast('Exportando...');
composeToOff(includeTemplate);
const link=document.createElement('a'); link.href=off.toDataURL('image/png'); link.download='skin.png'; link.click();
}
document.getElementById('exportClean').addEventListener('click',()=>exportImage(false));
document.getElementById('exportWith').addEventListener('click',()=>exportImage(true));

// Save / Load
document.getElementById('saveProj').addEventListener('click',()=>{
const data={layers,template:null}; if(templateImg)data.template=off.toDataURL();
localStorage.setItem('ssproj',JSON.stringify(data)); showToast('Projeto salvo');
});
document.getElementById('loadProj').addEventListener('click',()=>{
const data=JSON.parse(localStorage.getItem('ssproj')||'{}'); if(!data.layers)return;
layers=data.layers; if(data.template){const i=new Image(); i.onload=()=>{templateImg=i; draw();}; i.src=data.template;}
rebuildLayersList(); draw(); showToast('Projeto carregado');
});
document.getElementById('resetProj').addEventListener('click',()=>{layers=[];templateImg=null;selectedId=null;document.getElementById('layerControls').style.display='none';rebuildLayersList();draw();showToast('Resetado');});

draw();
</script>
</body>
</html>
